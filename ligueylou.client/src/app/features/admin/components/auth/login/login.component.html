<div class="flex flex-col min-h-screen">

  <!-- MAIN -->
  <main class="flex-1 flex items-center justify-center py-12 bg-gradient-to-r from-green-50 to-emerald-50">
    <div class="container px-4 flex justify-center">
      <div class="card w-full max-w-md bg-white shadow-xl">

        <!-- Card Header -->
        <div class="card-body">
          <h2 class="text-2xl font-bold text-center mb-2">Connexion</h2>
          <p class="text-center text-gray-500 mb-8">
            Connectez-vous pour acc√©der √† vos services et r√©servations
          </p>
          @if(error()) {
          <div class="mb-4 p-3 text-sm bg-red-100 text-red-700 rounded-lg">
            {{ error() }}
          </div>
          }


          <!-- Tabs using DaisyUI -->
          <div class="mb-8">
            <div class="tabs tabs-box p-1 w-full grid grid-cols-2">
              <input type="radio"
                     name="login_tabs"
                     class="tab"
                     aria-label="Email"
                     [checked]="activeTab === 'email'"
                     (change)="setActiveTab('email')" />
              <input type="radio"
                     name="login_tabs"
                     class="tab"
                     aria-label="T√©l√©phone"
                     [checked]="activeTab === 'phone'"
                     (change)="setActiveTab('phone')" />
            </div>
          </div>
          <!-- EMAIL FORM -->
          @if (activeTab === 'email') {
          <div class="mt-2">
            <form [formGroup]="emailForm" (ngSubmit)="submitEmail()">
              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                  <input type="email"
                         placeholder="exemple@email.com"
                         class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"
                         formControlName="email"
                         name="email" />
                    @if (emailForm.controls.email.touched && emailForm.controls.email.invalid) {
                    <p class="text-red-500 text-sm">Email invalide</p>
                    }
                </div>

                <div>
                  <div class="flex justify-between items-center mb-2">
                    <label class="block text-sm font-medium text-gray-700">Mot de passe</label>
                    <a routerLink="/forgot-password" class="text-sm text-green-600 hover:text-green-700 hover:underline">
                      Mot de passe oubli√© ?
                    </a>
                  </div>
                  <div class="relative">
                    <input [type]="showPassword ? 'text' : 'password'"
                           class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent pr-12"
                           formControlName="password"
                           name="password" />
                    <button type="button"
                            class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700"
                            (click)="togglePasswordVisibility()">
                      @if (!showPassword) {
                      <span class="text-lg">üëÅÔ∏è</span>
                      }
                      @if (showPassword) {
                      <span class="text-lg">üôà</span>
                      }
                    </button>
                  </div>
                  @if (emailForm.controls.password.touched && emailForm.controls.password.invalid) {
                  <p class="text-red-500 text-sm">Mot de passe requis</p>
                  }
                </div>

                <div class="flex items-center gap-3">
                  <input type="checkbox"
                         id="remember"
                         class="w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"
                         formControlName="remember"
                         name="remember" />
                  <label for="remember" class="text-sm text-gray-700">Se souvenir de moi</label>
                </div>

                <button type="submit"
                        class="w-full py-3 bg-green-500 hover:bg-green-600 text-white font-medium rounded-lg transition duration-200"
                        [disabled]="loading() || emailForm.invalid">
                  <ng-container *ngIf="loading(); else normal">
                    <div class="flex items-center justify-center">
                      <div class="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"></div>
                      Connexion...
                    </div>
                  </ng-container>
                  <ng-template #normal>
                    Se connecter
                  </ng-template>
                </button>

              </div>
            </form>
          </div>
          }

          <!-- PHONE FORM -->
          @if (activeTab === 'phone') {
          <div class="mt-2">
            <form [formGroup]="phoneForm"  (ngSubmit)="submitPhone()">
              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">T√©l√©phone</label>
                  <input type="tel"
                         placeholder="77 123 45 67"
                         class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"
                         formControlName="telephone"
                         name="telephone"/>
                  @if(phoneForm.controls.telephone.touched && phoneForm.controls.telephone.invalid){
                  <p class="text-red-500 text-sm">Telephone invalide</p>
                  }
                </div>
                <div>
                  <div class="flex justify-between items-center mb-2">
                    <label class="block text-sm font-medium text-gray-700">Mot de passe</label>
                    <a routerLink="/forgot-password" class="text-sm text-green-600 hover:text-green-700 hover:underline">
                      Mot de passe oubli√© ?
                    </a>
                  </div>
                  <div class="relative">
                    <input [type]="showPassword ? 'text' : 'password'"
                           class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent pr-12"
                           formControlName="password"
                           name="password" />
                    <button type="button"
                            class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700"
                            (click)="togglePasswordVisibility()">
                      @if (!showPassword) {
                      <span class="text-lg">üëÅÔ∏è</span>
                      }
                      @if (showPassword) {
                      <span class="text-lg">üôà</span>
                      }
                    </button>
                  </div>
                  @if (phoneForm.controls.password.touched && phoneForm.controls.password.invalid) {
                  <p class="text-red-500 text-sm">Mot de passe requis</p>
                  }
                </div>
                <button type="submit"
                        class="w-full py-3 bg-green-500 hover:bg-green-600 text-white font-medium rounded-lg transition duration-200"
                        [disabled]="loading() || phoneForm.invalid">
                  <ng-container *ngIf="loading(); else normal">
                    <div class="flex items-center justify-center">
                      <div class="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"></div>
                      Envoi...
                    </div>
                  </ng-container>
                  <ng-template #normal>
                    Se Connecter
                  </ng-template>
                </button>
              </div>
            </form>
          </div>
          }

        </div>
      </div>
    </div>
  </main>

</div>
